<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

        <title>Angular - Introduction</title>

        <link rel="stylesheet" href="css/reveal.css">
        <link rel="stylesheet" href="css/theme/black.css">
        <link rel="stylesheet" href="css/custom.css">

        <!-- Theme used for syntax highlighting of code -->
        <link rel="stylesheet" href="lib/css/zenburn.css">

        <!-- Printing and PDF exports -->
        <script>
            // var link = document.createElement('link');
            // link.rel = 'stylesheet';
            // link.type = 'text/css';
            // link.href = window.location.search.match(/print-pdf/gi) ? 'css/print/pdf.css' : 'css/print/paper.css';
            // document.getElementsByTagName('head')[0].appendChild(link);
        </script>
        <style>
        .custom-image {
          background-color: transparent !important; 
          border: none !important; 
          box-shadow: none !important;
        }</style>
    </head>
    <body>
        <div class="reveal">
            <div class="slides">
                <section>
                    <p><img src="https://angular.io/assets/images/logos/angular/angular.svg" style="width: 250px;" class="custom-image" alt="Angular"></p>
                    <p class="fragment">A platform and framework for building client applications in HTML and TypeScript.</p>
                </section>  

                <section>
                    <!-- NPM -->
                    <section>
                        <p>Node Package Manager (npm)</p>
                        <p>You can find all the packages on npmjs.org</p>
                    </section>

                    <section>
                        <p>In order to install a package you have to wirte: </p>
                        <p>npm install package_name </p> <br />
                        <p>The module will be installed in a directory called node_modules inside the directory where you ran the command from.</p> <br />
                        <p>In order to install it globally you can specify -g flag</p>
                    </section>

                    <section>
                        <p>All the project dependencies are listed in a package.json file</p>
                        <p>The npm install command will add the package as an entry to the package.json file (if it exists)</p>
                        <p>To create the package.json write:</p>
                        <p>npm init</p>
                    </section>

                    <section>
                        <img src="./img/npm_versioning.png">
                    </section>

                    <section>
                        <p>All the packages are installed by default under the dependencies listing</p> <br />
                        <p>To install it under the devDependencies you need to specify the -D flag</p>
                    </section>

                    <section>
                        <p>In order to install only the dependencies listed under the dependencies section (without devDependencies)</p> <br />
                        <p style="color: green;"> npm i --production </p>
                    </section>

                    <section>
                        <p>npm scripts</p>
                        <p>pre/post scripts</p>
                        <pre>
                            <code data-trim class="hljs javascript ">
"scripts": {
    "preinstall": "scripts/preinstall.js"
    "install" : "scripts/install.js", 
    "postinstall" : "scripts/postinstall.js",
    "start:server": "app/server.js"
}
                            </code>
                        </pre>
                        <p>Running the npm install command will first run the preinstall, followed by the install and finally the postinstall</p>
                        <p>In order to run the start:server script we need to use: npm run start:server (run tells npm to execute the file)</p>
                    </section>

                    <section>
                        <p>package-lock.json</p>
                        <p>Pakcage lock is a file that ensures that every environment where the npm install is run will have the same version of dependencies as the user who installed them.</p>
                        <p>Push the package-lock.json to the repository as well.</p>
                    </section>

                    <section>
                        <p>Don't forget to place the node_modules in the .gitignore file, we shouldn't push that to the repository!</p>
                    </section>

                    <section>
                        <h4>Kahoot</h4>
                        <a href="https://play.kahoot.it/v2/?quizId=872dd2d5-6f9a-48aa-a287-86f69bcabbe5" target="_blank">npm</a>
                    </section>

                    <section>
                        <p>Recap</p>
                        <ul>
                            <li>npm is a dependency managment tool</li>
                            <li>We can install packages using the npm install command</li>
                            <li>We can run scripts that are not overriding default npm commands using the: npm run script_name</li>
                            <li>Don't forget to ignore the node_modules so that it's not pushed to the repository</li>
                        </ul>
                    </section>
                </section>

                <!-- Typescript -->

                <section>
                    <section>
                        <p>Intro into TypeScript</p>
                        <ul>
                            <li>A superset of JavaScript created by Microsoft</li>
                            <li>Supports types, classes, interfaces, generics, annotations</li>
                            <li>Easy to learn by Java, C#, and C++ developers</li>
                            <li>Transpiles code into a human-readable JavaScript</li>
                            <li>Supports most of the ES6 and some ES7 syntax</li>
                        </ul>
                    </section>
                    
                    <section>
                        <h2>Transpiling TypeScript Interactively</h2>
                        <div class="left-column fragment">
                            <p>TypeScript</p>
                            <pre>
                                <code class="hljs javascript">
let foo: string;
class Bar {

}
                                    </code>
                                </pre>
                            </div>
                            <div class="right-column fragment">
                            <p>JavaScript (ES5)</p>
                                <pre>
                                    <code class="hljs javascript">
var foo;
var Bar = (function () {
    function Bar() {
    }
    return Bar;
}());
                                </code>
                            </pre> 
                        </div>                        
                    </section>

                    <section>
                        <h3>Classes</h3>
                        <div class="left-column fragment">
                            <p>TypeScript</p>
                            <pre>
                                <code class="hljs javascript">
class Person {
    public firstName: string;
    public lastName: string;
    public age: number;
}

let p = new Person();

p.firstName = "John";
p.lastName = "Smith";
p.age = 29;
                                </code>
                            </pre>
                        </div>
                        <div class="right-column fragment">
                            <p>JavaScript (ES5)</p>
                            <pre>
                                <code class="hljs javascript">
var Person = (function () {
    function Person() {
    }
    return Person;
}());

var p = new Person();

p.firstName = "John";
p.lastName = "Smith";
p.age = 29;
                                </code>
                            </pre>
                        </div>
                    </section>

                    <section>
                        <h3>Optional types</h3>
                        <div class="left-column fragment">
                            <p>TypeScript</p>
                            <pre>
                                <code class="hljs javascript">
//Implicit types
let productName = 'BMW';
productName = 'Mercedes';
// compile error in TS
productName = 123; 

// Explicit types
let productVendor: string = 'Samsung';
productVendor = 'Sony';
// compile error in TS
productVendor = 123; 
                                </code>
                            </pre>
                        </div>
                        <div class="right-column fragment">
                            <p>JavaScript (ES5)</p>
                            <pre>
                                <code class="hljs javascript">
// Implicit types
var productName = 'BMW';
productName = 'Mercedes';
// no compiler error in JS
productName = 123; 
                                </code>
                            </pre>
                        </div>
                    </section>

                    <section>
                        <h3>A Class With Constructor. Take 1</h3>
                        <div class="left-column fragment">
                            <p>TypeScript</p>
                            <pre>
                                <code data-trim data-noescape class="hljs javascript small-font-code" >
class Person {
    public firstName: string;
    public lastName: string;
    public age: number;
    private _ssn: string;

    constructor(firstName: string, lastName: string, age: number, ssn: string) {
        this.firstName = firstName;
        this.lastName = lastName;
        this.age = age;
        this._ssn = ssn;
    }
}
var p = new Person("John", "Smith", 29, "123-90-4567");
console.log("Last name: " + p.lastName + " SSN: " + p.<mark>_ssn</mark>);
                                </code>
                            </pre>
                        </div>
                        <div class="right-column fragment">
                            <p>JavaScript (ES5)</p>
                            <pre>
                                <code data-trim class="hljs javascript small-font-code">
var Person = (function () {
    function Person(firstName, lastName, age, ssn) {
        this.firstName = firstName;
        this.lastName = lastName;
        this.age = age;
        this._ssn = ssn;
    }
    return Person;
}());
var p = new Person("John", "Smith", 29, "123-90-4567");
console.log("Last name: " + p.lastName + " SSN: " + p._ssn);
                                </code>
                            </pre>
                        </div>
                    </section>

                    <section>
                        <h3>A Class With Constructor. Take 2</h3>
                        <div class="left-column fragment">
                            <p>TypeScript</p>
                            <pre>
                                <code data-trim data-noescape class="hljs javascript small-font-code">
class Person {
    constructor(
        public firstName: string, 
        public lastName: string, 
        public age: number, 
        private _ssn: string
    ) { }
}

var p = new Person("John", "Smith", 29, "123-90-4567");
console.log("Last name: " + p.lastName + " SSN: " + p.<mark>_ssn</mark>);
                                </code>
                            </pre>
                        </div>
                        <div class="right-column fragment">
                            <p>JavaScript (ES5)</p>
                            <pre>
                                <code data-trim class="hljs javascript small-font-code">
var Person = (function () {
    function Person(firstName, lastName, age, _ssn) {
        this.firstName = firstName;
        this.lastName = lastName;
        this.age = age;
        this._ssn = _ssn;
    }
    return Person;
}());
var p = new Person("John", "Smith", 29, "123-90-4567");
console.log("Last name: " + p.lastName + " SSN: " + p._ssn);
                                </code>
                            </pre>
                        </div>
                    </section>

                    <section>
                        <h3>Inheritance</h3>
                        <div class="left-column fragment">
                            <p>Classical syntax</p>
                            <pre>
                                <code data-trim class="hljs javascript small-font-code">
class Person {
    constructor(
        public firstName: string, 
        public lastName: string, 
        public age: number, 
        private _ssn: string
    ) { }
}

class Employee extends Person { }
                                </code>
                            </pre>
                        </div>
                        <div class="right-column fragment">
                            <p>Prototypal</p>
                            <pre>
                                <code data-trim class="hljs javascript small-font-code">
var __extends = (this && this.__extends) || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
};
var Person = (function () {
    function Person(firstName, lastName, age, _ssn) {
        this.firstName = firstName;
        this.lastName = lastName;
        this.age = age;
        this._ssn = _ssn;
    }
    return Person;
}());
var Employee = (function (_super) {
    __extends(Employee, _super);
    function Employee() {
        return _super.apply(this, arguments) || this;
    }
    return Employee;
}(Person));
                                </code>
                            </pre>
                        </div>
                    </section>

                    <section>
                        <h3>Generics</h3>
                        <div class="left-column fragment">
                            <p>TypeScript</p>
                            <pre>
                                <code data-trim  data-noescape class="hljs javascript small-font-code">
class Person {
    name: string;
}

class Employee extends Person {
    department: number;
}


class Animal {
    breed: string;
}

let workers: Array&lt;Person&gt; = [];
workers[0] = new Person();
workers[1] = new Employee();
<mark>workers[2] = new Animal(); //A compile time error</mark>
                                </code>
                            </pre>
                        </div>
                        <div class="right-column fragment">
                            <p>JavaScript</p>
                            <pre>
                                <code data-trim class="hljs javascript small-font-code">
var __extends = (this && this.__extends) || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
};
var Person = (function () {
    function Person() {
    }
    return Person;
}());
var Employee = (function (_super) {
    __extends(Employee, _super);
    function Employee() {
        return _super.apply(this, arguments) || this;
    }
    return Employee;
}(Person));
var Animal = (function () {
    function Animal() {
    }
    return Animal;
}());
var workers = [];
workers[0] = new Person();
workers[1] = new Employee();
workers[2] = new Animal(); //No errors

                                </code>
                            </pre>
                        </div>
                    </section>

                    <section>
                        <h3>Interfaces as Custom Types</h3>
                        <div class="left-column fragment">
                            <p>TypeScript</p>
                            <pre>
                                <code data-trim class="hljs javascript small-font-code">
interface IPerson {
    firstName: string;
    lastName: string;
    age?: number;
}

class Person {
    constructor(public config: IPerson) { }
}

const aPerson: IPerson = {
    firstName: "John",
    lastName: "Smith",
    age: 29
}

const p = new Person(aPerson);
console.log("Last name: " + p.config.lastName);
                                </code>
                            </pre>
                        </div>
                        <div class="right-column fragment">
                            <p>JavaScript</p>
                            <pre>
                                <code data-trim class="hljs javascript small-font-code">
var Person = (function () {
    function Person(config) {
        this.config = config;
    }
    return Person;
}());
var aPerson = {
    firstName: "John",
    lastName: "Smith",
    age: 29
};
var p = new Person(aPerson);
console.log("Last name: " + p.config.lastName);
//No interfaces here
                                </code>
                            </pre>
                        </div>
                    </section>

                    <section>
                        <h3>Interfaces and implements</h3>
                        <div class="left-column fragment">
                            <p>TypeScript</p>
                            <pre>
                                <code data-trim class="hljs javascript small-font-code">
interface IPayable {
    increasePay(percent: number): void
}
class Employee implements IPayable {
    increasePay(percent: number) {
        //increase salary
    }
}
class Contractor implements IPayable {
    increasePay(percent: number): void {
        //increase hourly rate
    }
}

let workers: Array&lt;IPayable&gt; = [];
workers[0] = new Employee();
workers[1] = new Contractor();
workers.forEach(worker => worker.increasePay(30));
                                </code>
                            </pre>
                        </div>
                        <div class="right-column fragment">
                            <p>JavaScript</p>
                            <pre>
                                <code data-trim class="hljs javascript small-font-code">
var Employee = (function () {
    function Employee() {
    }
    Employee.prototype.increasePay = function (percent) {
        //increase salary
    };
    return Employee;
}());
var Contractor = (function () {
    function Contractor() {
    }
    Contractor.prototype.increasePay = function (percent) {
        //increase hourly rate
    };
    return Contractor;
}());
var workers = [];
workers[0] = new Employee();
workers[1] = new Contractor();
workers.forEach(function (worker) { return worker.increasePay(30); });
                                </code>
                            </pre>
                        </div>
                    </section>

                    <section>
                        <p>Installing the TypeScript transpiler</p>
                        <p style="color: green">npm i -g typescript</p><br />

                        <p>To transpile a typescript file (.ts) to a .js file:</p>
                        <p><span style="color: green">tsc —t ES5 file_name </span> (-t specifies the target to be ES5 the standard supported by all browsers)</p>
                    </section>

                    <section>
                        <p>TypeScript configuration file (tsconfig.json)</p>
                        <p>Saves us from writing tons of flags</p>
                        <a href="https://www.typescriptlang.org/docs/handbook/compiler-options.html">List of all the options</a>
                        <pre>
                            <code class="hljs javascript">
{
    "compilerOptions": {
        "rootDir": "src",
        "outDir": "./dist/out-tsc",
        "target": "ES5",
        "module": "commonjs",
        "experimentalDecorators": true, // used by Angular
        "sourceMap": true
    },
    "include": [
        "src/**/*"
    ],
    "exclude": [
        "node_modules",
        "**/*.spec.ts"
    ]
}
                            </code>
                        </pre>
                    </section>

                    <section>
                        <p>If the tsconfig.json is not in the current directory specify the</p>
                        <p><span style="color: green;">--project</span> flag with the relative path to the tsconfig</p>
                    </section>

                    <section>
                        <p>Recap</p>
    
                        <ul>
                            <li>Typescript is a superset of JavaScript</li>
                            <li>Supports types, classes, interfaces, generics, decorators</li>
                            <li>Transpiles TypeScript code to human readable JavaScript</li>
                            <li>We can transpile .ts files using the tsc command</li>
                            <li>We should create a tsconfig.json file to store all our compiler options</li>
                        </ul>
                    </section>
                </section>

                <!-- The big picture -->
                
                <section>
                    <p>The big picture</p>
                    <img src="https://angular.io/generated/images/guide/architecture/overview2.png" alt="" class="custom-image">
                </section>

                <section>
                    <section>
                        <p>Angular CLI</p><br />
                
                        <a href="https://github.com/angular/angular-cli/wiki" target="_blank">Official documentation</a>
                    </section>
                
                    <section>
                        <p>The Angular CLI helps us with:</p>
                        <ul>
                            <li>Scaffolding a new project that will serve as the base for our application</li>
                            <li>Scaffolding components, directives, pipes, modules, etc.</li>
                            <li>Has a built in development server to run our application</li>
                            <li>Creates development and production builds</li>
                            <li>Has built in configurable test runner (Karma as the testing framework and Jasmine as the assertion
                                library)</li>
                        </ul>
                    </section>
                
                    <section>
                        <p>Setting up the CLI</p>
                        <ol>
                            <li>npm i -g @angular/cli</li>
                            <li>ng new project_name (add the --style=scss in order to generate the project using the scss css
                                preprocessor)</li>
                            <li>cd project_name</li>
                            <li>ng serve -o</li>
                        </ol>
                    </section>
                
                    <section>
                        <p>Check the core files</p>
                        <ul>
                            <li>src directory</li>
                            <li>main.ts file</li>
                            <li>app.module</li>
                            <li>angular.json</li>
                            <li>package.json</li>
                        </ul>
                    </section>
                
                    <section>
                        <p>Angular CLI scaffolding commands</p>
                        <ul>
                            <li>ng g c component_name (ng generate component)</li>
                            <li>ng g s service_name (ng generate service)</li>
                            <li>ng g m module_name (ng generate module)</li>
                            <li>ng generate --help</li>
                        </ul>
                    </section>
                
                    <section>
                        <p>Recap</p>
                
                        <ul>
                            <li>We use the CLI to generate a new app (new new app_name)</li>
                            <li>We can use the CLI to scaffold components, services, modules, etc.</li>
                            <li>We use the CLI to serve our application in development mode</li>
                            <li>We use the CLI to start our test runners</li>
                        </ul>
                    </section>
                </section>

                <section>
                    <p>Clone traning application</p>
                    <pre>
                        <code data-trim class="hljs javascript">
git clone https://github.com/groszwilhelm/angular_workshop.git
cd angular_workshop
git fetch
git checkout brasov-training
npm i
npm start
                        </code>
                    </pre>
                </section>

                <!-- Angular components -->

                <section>
                    <section>
                    <p>Components</p>
                    <p class="fragment">- combination of an HTML template and a component class that controls a portion of the screen<br>
                    - class, decorator, metadata<br />
                    - defined views<br />
                    - use services</p>
<pre class="fragment">
    <code data-trim class="hljs javascript ">
import { Component } from '@angular/core';

@Component({
    selector: 'ngt-component', // wrapps the whole content
    template: ` // backtick
        <h1>Hello {{ name }}</h1>
    `,
    styleUrls: ['ngt-component.css']
    providers: [...]
})
export class NgtComponent { 
    protected name = 'Angular';
}
    </code>
</pre>
                    </section>

                    <section>
                        <p>Interpolation</p>
                        <pre class="fragment">
                            <code data-trim class="hljs javascript ">
import { Component } from '@angular/core';

@Component({
  selector: 'ngt-component',
  template: `
    <h1>{{ title }}</h1>
    <h2>My favorite car is: {{ myCar }}</h2>
    `
})
export class NgtComponent {
  protected title = 'Cars';
  protected myCar = 'Mercedes';
}
                            </code>
                        </pre>
                    </section>

                    <section>
                        <p>Property binding</p>
                        <pre class="fragment">
                            <code data-trim class="hljs javascript ">
import { Component } from '@angular/core';

@Component({
  selector: 'ngt-component',
  template: `
    <h2>My favorite car is 
        &lt;span [innerHTML]="favoriteCar"&gt;&lt;/span&gt;
    </h2>
    `
})
export class NgtComponent {
  protected favoriteCar = 'Mercedes';
}
                            </code>
                        </pre>
                    </section>

                    <section>
                        <p>Event binding</p>
                        <pre class="fragment">
                            <code data-trim class="hljs javascript ">
import { Component } from '@angular/core';

@Component({
  selector: 'ngt-component',
  template: `
    <button (click)="notify()">My button</button>
  `
})
export class NgtComponent {
  
  protected notify(): void {
    console.log("The button was clicked")
  }
}
                            </code>
                        </pre>
                    </section>

                    <section>
                        <p>Two way data binding (banana in the box)</p>
                        <pre class="fragment">
                            <code data-trim class="hljs javascript ">
import { Component } from '@angular/core';

@Component({
    selector: 'ngt-component',
    template: `
        &lt;input [(ngModel)]="username" /&gt;
    `
})
export class NgtComponent {
  
  protected username = 'Test';
}
                            </code>
                        </pre>
                    </section>

                    <section>
                        <p>Assignment</p>
                        <ul>
                            <li>Create a product property on the AppComponent and assign it the product</li>
                            <li>Create a product interface</li>
                            <li>Show the product title in the html</li>
                            <li>Show the product description in the html</li>
                            <li>Show the number of likes of a product</li>
                            <li>Show the number of comments of a product</li>
                            <li>Add src to the image tag</li>
                        </ul>
                    </section>

                    <section>
                        <h4>Kahoot</h4>
                        <a href="https://play.kahoot.it/v2/?quizId=2029668b-604e-4b70-9ac6-3778f05de2ce" target="_blank">Components</a>
                    </section>

                    <section>
                        <p>Recap</p>
                        <ul>
                            <li>Javascript code can be used in the html using interpolation {{ ... }}</li>
                            <li>We can bind to DOM node properties (and not only) using square brakets [value]</li>
                            <li>Binding to DOM events (and not only) can be achieved through round brakets (click)</li>
                            <li>Two way data binding can be achieved by combinding square and round brakets (banana in the box) [(ngModel)]</li>
                        </ul>
                    </section>
                </section>

                <!-- Inter-component communication -->
                <section>
                    <section>
                        <p> Inter-component communication </p> <br />
                        <p> - @Input and @Output properties </p>
                        <p> - Using a parent component as a mediator </p>
                    </section>

                    <section>
                        <p> @Input and @Output properties </p> <br />
                        <p> Think of a component as a black box with entry and exit doors </p>
                        <p> Properties marked as @Input() are used for getting data from the parent component </p>
                        <p> Properties marked as @Output() are used for sending events (and data) from a component </p>
                    </section>

                    <section>
                        <pre class="fragment">
                            <code data-trim class="hljs javascript ">
@Component({
    selector: 'ngt-parent',
    template: `
        &lt;ngt-child [renderInformation]="data"&gt;&lt;/ngt-child&gt;
    `
})
export class ParentComponent {
    protected data = { a: 'test', b: 'data' };
}

@Component({
    selector: 'ngt-child',
    template: `
        {{ renderInformation.a + ' ' + renderInformation.b }}
    `
})
export class ChildComponent {
    @Input() renderInformation: { a: string, b: string };
}
                            </code>
                        </pre>
                    </section>

                    <section>
                        <pre class="fragment">
                            <code data-trim class="hljs javascript ">
@Component({
    selector: 'ngt-parent',
    template: `
        <ngt-child (click$)="logEvent($event)"></ngt-child>
    `
})
export class ParentComponent {
    protected logEvent(event): void {
        console.log(event); // I have been clicked
    }
}

@Component({
    selector: 'ngt-child',
    template: `
        <button (click)="click$.emit('I have been clicked')">
            Click me
        </button>
    `
})
export class ChildComponent {
    @Output() click$ = new EventEmitter();
}
                            </code>
                        </pre>
                    </section>

                    <section>
                        <p>The Mediator acts as a man in the middle</p>
                        <p>A component A sends the data to a mediator, which passes the data to a component B</p>
                        <p>Component A and Component B don’t know about each other, the parent component can mediate siblings’ communications</p>
                        <p>An injectable service can mediate communication between any components</p>
                    </section>

                    <section>
                        <p>Component as a mediator</p>
                        <img src="img/component_as_mediator.png" alt="" class="custom-image">
                    </section>

                    <section>
                        <p>Assignment</p>
                        <ul>
                            <li>Create a product component</li>
                            <li>Move the product card (&lt;div class="col-md-4"&gt;) from the app.component.html to the newly created ProductComponent (html)  </li>
                            <li>Pass in the product from the AppComponent to the ProductComponent using @Input</li>
                            <li>Create an @Output from the ProductComponent that is triggered when the button is clicked</li>
                            <li>Create a ProductListComponent and move the interaction with the ProductComponent into it</li>
                        </ul>
                    </section>

                    <section>
                        <h4>Kahoot</h4>
                        <a href="https://play.kahoot.it/v2/?quizId=c4b8fe17-da02-4a24-ad76-b4348fff7c5f" target="_blank">Components communication</a>
                    </section>

                    <section>
                        <p>Recap</p>
                        <ul>
                            <li>Components receive data from their parents via @Input() properties.</li>
                            <li>Components send data to their parents by emiting data through their @Output() properties.</li>
                            <li>The mediator pattern helps us achieve inter-component communication through a loosely-coupled manner.</li>
                        </ul>
                    </section>
                </section>

                <!-- Content projection -->

                <section>
                    <section>
                        <p>Content projection</p>
                        <ul>
                            <li>It is used for passing HTML elements or Angular components to a child component</li>
                            <li>In order for the fragments to be rendered to the DOM, an &lt;ng-content&gt; tag will be used as a placeholder in the child where the actual content should be projected</li>
                        </ul>
                    </section>

                    <section>
                        <pre>
                            <code data-trim class="hljs javascript ">
@Component({
    selector: 'ngt-parent',
    template: `
        <h2>This is from the parent component</h2>
        <ngt-child>
            <div>Parent projects this element into the child</div>
            <ngt-data-component></ngt-data-component>
        </ngt-child>
    `
})
export class ParentComponent { }
                            </code>
                        </pre>

                        <pre>
                            <code data-trim class="hljs javascript ">
@Component({
    selector: 'ngt-child',
    template: `
        <h2>This is from the child component</h2>
        <ng-content></ng-content>
    `
})
export class ChildComponent { }
                            </code>
                        </pre>
                    </section>

                    <section>
                        <p>Multiple content projections</p>
                        <p>The "select" attribute allows the use of multiple targeted <br /> &lt;ng-content&gt; tags </p>
                        <p>It's an actual css selector, so any selector can be used: class, attribute, id, element</p>
                    </section>

                    <section>
                        <pre>
                            <code data-trim class="hljs javascript ">
@Component({
    selector: 'ngt-parent',
    template: `
        <h2>This is from the parent component</h2>
        <ngt-child>
            <span content-type="title">Title</span>
            <span content-type="description">Some description</span>
            <span content-type="generalInformation">General info</span>
        </ngt-child>
    `
})
export class ParentComponent { }


@Component({
    selector: 'ngt-child',
    template: `
        <h1>
            <ng-content select="[content-type=title]"></ng-content>
        </h1>
        <div>
            <ng-content select="[content-type=generalInformation]">
            </ng-content>
        </div>
        <div>
            <ng-content select="[content-type=description]">
            </ng-content>
        </div>
    `
})
export class ChildComponent { }
                            </code>
                        </pre>
                    </section>

                    <section>
                        <p>Assignment</p>
                        <ul>
                            <li>Pass in the product title to the ProductComponent using content projection</li>
                            <li>Pass in the product description to the ProductComponent using content projection</li>
                        </ul>
                    </section>

                    <section>
                        <h4>Kahoot</h4>
                        <a href="https://play.kahoot.it/v2/?quizId=d12f0402-b9d6-4142-bb66-4a1a67745f22" target="_blank">Content projection</a>
                    </section>

                    <section>
                        <p>Recap</p>
                        <ul>
                            <li>We can project content to a child component by using the &lt;ng-content&gt;</li>
                            <li>We can have multiple content projection by adding a select attribute to the &lt;ng-content&gt;</li>
                        </ul>
                    </section>
                </section>

                <!-- Directives -->

                <section>
                    <section>
                        <p>Directives</p>
                        <ol>
                          <li>A class annotated with @Directive()</li>
                          <li>Can't have it's own UI (HTML markup)</li>
                          <li>It can be attached to an HTML element (native element or component)</li>
                          <li>Structural directives—change the DOM layout by adding and removing DOM elements. (*ngFor, *ngIf, *ngSwitch)</li>
                          <li>Attribute directives—change the appearance or behavior of an element, component, or another directive.(ngClass, ngStyle)</li>
                        </ol>
                    </section>

                    <section>
                        <p>*ngIf</p>
                        <pre>
                            <code data-trim class="hljs javascript">
@Component({
    selector: 'ngt-example',
    template: `
        &lt;div *ngIf="showDetails"&gt;
            <h2>Details section</h2>
        &lt;/div&gt;
        <button (click)="showDetails = !showDetails">
            Toggle details
        </button>
    `
})
export class ExampleComponent { 
    protected showDetails = false;
}
                            </code>
                        </pre>
                    </section>

                    <section>
                        <p>*ngFor</p>
                        <pre>
                            <code data-trim class="hljs javascript">
@Component({
    selector: 'ngt-example',
    template: `
        <ul>
            &lt;li *ngFor="let product of products; let i = index;"&gt;
                {{ product.name }}, index: {{ i }}
            &lt;/li&gt;
        </ul>
    `
})
export class ExampleComponent { 
    protected products = [ 
        { name: 'product1' }, 
        { name: 'product2' }, 
        { name: 'product3' } 
    ];
}
                            </code>
                        </pre>
                    </section>

                    <section>
                        <p>*ngSwitch</p>
                        <pre>
                            <code data-trim class="hljs javascript">
@Component({
    selector: 'ngt-example',
    template: `
        &lt;div [ngSwitch]="country"&gt;
            &lt;div *ngSwitchCase="'DE'"&gt; ... &lt;/div&gt;
            &lt;div *ngSwitchCase="'SE'"&gt; ... &lt;/div&gt;
            &lt;div *ngSwitchCase="'FI'"&gt; ... &lt;/div&gt;
        &lt;/div&gt;
    `
})
export class ExampleComponent { 
    @Input() country = null;
}
                            </code>
                        </pre>
                    </section>
  
                    <section>
                      <p>Description of an attribute directive</p>
  <pre>
    <code data-trim class="hljs javascript">
import { Directive, ElementRef, HostListener, Input  } from '@angular/core';

@Directive({
  selector: '[appHighlight]'
})
export class HighlightDirective {
    @Input() highlightColor: string = 'white';

    constructor(private el: ElementRef) { }

    @HostBinding('class.red') red = true;

    @HostListener('mouseenter') onMouseEnter() {
        this.highlight(highlightColor);
    }

    @HostListener('mouseleave') onMouseLeave() {
        this.highlight(null);
    }

    private highlight(color: string) {
        this.el.nativeElement.style.backgroundColor = color;
    }
}</code>
  </pre>
                    </section>
                    <section>
                        <p>Usage of an attribute directive</p>
                        <pre>
                            <code data-trim class="hljs javascript">                    
&lt;p appHighlight [highlightColor]="blue"&gt;Highlight me!&lt;/p&gt;

&lt;ngt-component appHighlight [highlightColor]="blue"&gt;
    Highlight me!
&lt;/ngt-component&gt;
                            </code>
                        </pre>
                    </section>

                    <section>
                        <p>Assignment</p>
                        <ul>
                            <li>Add a products property on the ProductListComponent and assign it the products array from the product-list.ts</li>
                            <li>Specify a type for the products property</li>
                            <li>Use *ngFor to display the full list of products</li>
                            <li>Create a ZoomDirective that will make the image grow when hovered</li>
                        </ul>
                    </section>

                    <section>
                        <h4>Kahoot</h4>
                        <a href="https://play.kahoot.it/v2/?quizId=5d568108-f4a7-4a23-b97b-c037bb6f221f" target="_blank">Directives</a>
                    </section>

                    <section>
                        <p>Recap</p>

                        <ul>
                            <li>Directives can be attached to and HTML tag or a component to enchance the functionality/appearance</li> <br />
                            <li>We have two kind of directives: 
                                <ul>
                                    <li>structural directives (*ngIf, *ngFor, *ngSwitch)</li>
                                    <li>attribute directives (ngClass, ngStyle)</li>
                                </ul> 
                            </li>
                        </ul>
                    </section>
                  </section>

                <!-- The View -->
                
                <section>
                    <section>
                        <h3>The View</h3>
                        <ul>
                            <li>Core concept of Angular</li>
                            <li>Every component is represented as the View</li>
                            <li>It's an abstraction that associates DOM nodes with the component class</li>
                        </ul>
                    </section>
                
                    <section>
                        <h3>Component to View</h3>
                        <img src="./img/view-compiler.png" />
                    </section>
                
                    <section>
                        <h3>DOM and View (one way relation)</h3>
                        <img src="./img/view-dom.png" />
                    </section>

                    <section>
                        <ul>
                            <li>
                                @ViewChild
                            </li>
                            <li>
                                @ViewChildren
                            </li>
                            <li>
                                @ContentChild
                            </li>
                            <li>
                                @ContentChildren
                            </li>
                        </ul>
                    </section>
                
                    <section>
                        <h3>DOM and View (one way relation)</h3>
                        <img src="./img/viewContainer.png" />
                    </section>
                
                </section>

                <section>
                    <section>
                        <h2>Dynamic components</h2>
                        <p>Create a dynamic modal component in order to randomly add another product to the list.</p>
                    </section>
                </section>

                <!-- Pipes -->

                <section>
                    <section>
                        <p>Pipes</p>
                        <p>They are functions that help us process data in the template (HTML)</p>
                    </section>

                    <section>
                        <pre>
                            <code data-trim class="hljs javascript">
import { Pipe, PipeTransform } from '@angular/core';

/*
  * Returns '-'' if the data is null or undefined
  * Usage:
  *   value | emptyValue
  * Example:
  *   {{ undefined | emptyValue }}
  *   formats value to: '-'
*/
@Pipe({ name: 'emptyValue' })
export class EmptyValueFormatterPipe implements PipeTransform {
  transform(value: any): string {
    if (value != null && !value.isUndefined && value !== 'null') {
      return value;
    } else {
      return '-';
    }
  }
}                    
                            </code>
                        </pre>
                    </section>

                    <section>
                        <pre>
                            <code data-trim class="hljs javascript">
import { Component } from '@angular/core';

@Component({
    selector: 'ngt-example',
    template: `
        <h2> {{ username | emptyValue }} </h2>
    `  
})  
export class ExampleComponent {
    protected username = null;
}                
                            </code>
                        </pre>
                    </section>

                    <section>
                        <p>Assignment</p>
                        <ul>
                            <li>Create a CurrencyPipe that adds a currency after the price of the product </li>
                        </ul>
                    </section>
                </section>
            
                <!-- Services and dependency injection -->
                
                <section>
                    <section>
                        <p>Services and Dependency Injection</p>
                        <ul>
                            <li>Don’t instantiate classes with the new operator</li>
                            <li>Angular creates and injects services into components, directives or other services</li>
                            <li>Angular can create and inject values into variables</li>
                        </ul>
                    </section>

                    <section>
                        <ul>
                            <li>We can inject services into components, directives or services using the constructor</li>
                            <li>In order to inject a service / value, angular needs to have that defined in the providers section in a module/component</li>
                        </ul>
                    </section>

                    <section>
                        <pre>
                            <code data-trim class="hljs javascript ">
import { Injectable } from '@angular/core';

// @Injectable(provideIn: 'root')
@Injectable()
export class ListApiService { 
    ...
}
                            </code>
                        </pre> 
    
                        <pre>
                            <code data-trim class="hljs javascript ">
import { Component } from '@angular/core';

@Component({
  selector: 'ngt-component',
  template: ``
})
export class AppComponent {
    constructor(private listApiService: ListApiService) { }
}
                            </code>
                        </pre>
                    </section>

                    <section>
                        <pre>
                            <code data-trim class="hljs javascript ">
@NgModule({
    providers: [{ 
        provide: ListApiService,
        useClass: ListApiService
    }]
})
class AppModule { }

// short hand
@NgModule({
    providers: [ListApiService]
})
class AppModule { }
                            </code>
                        </pre>

                        <pre>
                            <code data-trim class="hljs javascript ">
@NgModule({
    providers: [{ 
        provide: ListApiService,
        useClass: MockedApiService
    }]
})
class AppModule { }
                            </code>
                        </pre>
                    </section>

                    <section>
                        <p>@Inject() decorator</p>
                        <p>Allows us to specify the token type</p>
                        <pre>
                            <code data-trim class="hljs javascript ">
import { Component, Inject } from '@angular/core';

@Component({
  selector: 'ngt-component',
  template: ``
})
export class AppComponent {
    constructor(@Inject(ListApiService) private listApiService) { }
}
                            </code>
                        </pre>
                    </section>

                    <section>
                        <pre>
                            <code data-trim class="hljs javascript ">
import { Component, Inject, InjectionToken } from '@angular/core';

export const BACKEND_URI = new InjectionToken('BackendUri');   

@Component({
  selector: 'ngt-component',
  template: ``,
  providers: [{ provide: BACKEND_URI, useValue: 'qa-server.com' }]
})
export class AppComponent {
    constructor(@Inject(BACKEND_URI) private uri) { }
}
                            </code>
                        </pre>
                    </section>

                    <section>
                        <h4>Mediator pattern</h4>
                        <p>Service as a mediator</p>
                        <img src="img/service_as_mediator.png" alt="" class="custom-image">
                    </section>

                    <section>
                        <p>Assignment</p>
                        <ul>
                            <li>Create a ListService </li>
                            <li>Create a method that returns the product list from the ListService and use that in the ProductListComponent</li>
                            <li>Create a MockListService with some dummy data and inject that instead of the ListService</li>
                        </ul>
                    </section>

                    <section>
                        <h4>Kahoot</h4>
                        <a href="https://play.kahoot.it/v2/?quizId=ada31e91-cc8f-485c-aaf5-8e959a0e8840" target="_blank">Services</a>
                    </section>
                </section>

                <section>
                    <section>
                        <h3>Lifecycle Hooks</h3>
                        <a href="https://angular.io/guide/lifecycle-hooks#lifecycle-sequence" target="_blank">https://angular.io/guide/lifecycle-hooks#lifecycle-sequence</a>
                    </section>

                    <section>
                       <ul>
                        <li>Component gets created and initialized</li>
                        <li>Change-detection mechanism starts monitoring the component</li>
                        <li>You can intercept component lifecycle’s key moments by implementing lifecycle hook interfaces</li>
                        <li>Angular calls the hooks only if you implemented them</li>
                        <li>Component gets destroyed</li>
                       </ul>
                    </section>

                    <section>
                        <img src="./img/lifecycle.png" />
                    </section>

                    <section>
                        <p>
                            Each interface has a single hook method whose name is the interface name prefixed with ng.
                            For example, the <i>OnInit</i> interface has a hook method named <i>ngOnInit</i> that Angular calls shortly after creating the component
                        </p>
                        <pre class="fragment">
                        <code data-trim class="hljs javascript">
export class CarComponent implements OnInit {
    // implement OnInit's `ngOnInit` method
    ngOnInit() { 
        console.log("On init car component"); 
    }
}
                            </code>
                        </pre>
                    </section>

                    <section>
                        <p class="fragment">Change Detection (CD)</p>
                        <ul>
                            <li class="fragment">CD is about updating the view whenever the underlying model changes </li>
                            <li class="fragment">CD is implemented in the library zone.js </li>
                            <li class="fragment">When async event happens in your browser’s app, CD starts checking components and updates the views </li>
                            <li class="fragment">CD runs unidirectionally from the root of the component tree to each leaf </li>
                            <li class="fragment">Each component has its own change detector that checks if the values in its template expressions (e.g. {{prodTitle}} or [prodId]="productId") has changed.</li>
                        </ul>
                    </section>

                    <section>
                        <p>CD strategies: Default vs OnPush</p>
                        <p style="font-size: 0.7em;">changeDetection: ChangeDetectionStrategy.OnPush</p>
                        <img style="height: 300px;" src="./img/CD_1.png" />
                        <p style="font-size: 0.7em;">With OnPush strategy the Zone won’t check a component unless the reference of the value bound to its @Input properties change. </p>
                    </section>

                    <section>
                        <p>CD strategies: Default vs OnPush</p>
                        <img style="height: 300px;" src="./img/CD_2.png" />
                        <p style="font-size: 0.7em;">A change in GrandChild1 will cause change detection in all components shown with blue background. </p>
                    </section>

                    <section>
                        <p>We would still like to trigger CD in the OnPush component</p>

                        <pre class="fragment">
                            <code data-trim class="hljs javascript">
@Component({
selector: 'ngt-component',
template: `
    <h2>{{car.id}}</h2>
    <h2>{{car.name}}</h2>
`,
    changeDetection: ChangeDetectionStrategy.OnPush
})
export class CarDetailsComponent {
    protected car: { id, name };

    constructior(
        private productService: ProductService,
        private cd: ChangeDetectorRef
    ) { 
        this.loadData(7);
    }

    private loadData(id: number) {
        this.productService.getCarById(id)
            .subscribe(car => {
                this.car = car; // CD won't run
                this.cd.detectChanges(); // runs for component and all children
            });
    }
}
                            </code>
                        </pre>
                    </section>

                    <section>
                        <h4>Mutable vs Immutable JavaScript primitives are immutable</h4>
                        <pre class="fragment">
                            <code data-trim class="hljs javascript">
// Allocates an address in memory for greeting 
let greeting = 'Hello';
// Allocates another address in memory
greeting = 'Hello Mary'; 

// Allocates an address for the var user 
let user = {name: 'John'}; 
// The address of the var user remains the same 
user.name = 'Mary'
                            </code>
                        </pre>
                    </section>

                    <section>
                        <h4>Kahoot</h4>
                        <a href="https://play.kahoot.it/v2/?quizId=5ea690fb-bcf4-4425-a4fe-94969d6a7ca2" target="_blank">Change Detection</a>
                    </section>

                    <section>
                        <p>Recap</p>

                        <ul>
                            <li>Angular invokes the lifecycle hooks at a given time during the component lifetime</li>
                            <li>Fetching of the data should be placed in the ngOnInit implementation</li>
                            <li>Change detection is performed automatically using zone.js library</li>
                            <li>We can stop the automatic change detection to improve performance, with ChangeDetection.OnPush but it's up to us to trigger it when needed</li>
                        </ul>
                    </section>
                </section>

                <section>
                    <section>
                        <h4>Observables</h4>
                        <p>Stream of events you can process with array like operators</p>
                        <p>Streams: series of values in time</p>
                    </section>

                    <section>
                        <li>Observable - data stream that pushes data over time </li>
                        <li>Observer - consumer of an observable stream </li>
                        <li>Subscriber - connects observer with observable </li>
                        <li>Operator - en-route data transformation</li>
                    </section>

                    <section>
                        <img src="./img/stream.png" />
                    </section>

                    <section>
                        <h4>The Observer can provide</h4>
                        <li>A function to handle the next value from the stream </li>
                        <li>A function to handle errors</li>
                        <li>A function to handle end-of-stream</li>
                    </section>

                    <section>
                        <h4>Creating Observables</h4>
                        <pre>
                            <code class="hljs javascript">
from([1, 2, 3]) // converts an array or iterable into an Observable
of(1, 2, 3) // turns a sequence of values into an Observable
fromEvent(inputElement, 'keyup') // converts an event into an Observable
interval(1000) // emits an integer every second
                            </code>
                        </pre>
                    </section>

                    <section>
                        <h4>Marble Diagrams</h4>
                    </section>
                    
                    <section>
                        <h4>Map</h4>
                        <img src="./img/map.png" />
                    </section>
                    
                    <section>
                        <h4>Filter</h4>
                        <img src="./img/filter.png" />
                    </section>
                    
                    <section>
                        <h4>Debounce Time</h4>
                        <img src="./img/debounceTime.png" />
                    </section>

                    <section>
                        <img src="./img/rxjs.png" />
                    </section>

                    <section>
                        <h4>Hands On</h4>
                    </section>

                    <section>
                        <h4>Kahoot</h4>
                        <a href="https://play.kahoot.it/v2/?quizId=f1e995fe-0307-4642-b29c-043863d95c73" target="_blank">Observables</a>
                    </section>
                </section>

                <!-- Ng modules -->
                <section>
                    <section>
                        <p>Modules / Refactoring the app</p>
                    </section>

                    <section>
                        <p class="fragment">A mechanism to group components, directives, pipes and services that are related</p>
                        <p class="fragment">Similar to ES6 Modules ( <i>declarations, imports, exports</i> )</p>
                        <div class="fragment">
                        <pre>
                            <code class="hljs javascript">
import { NgModule } from '@angular/core';
...

@NgModule({ //decorator
  imports: [BrowserModule],
  declarations: [AppComponent],
  exports: [...],
  providers: [...],
  bootstrap: [AppComponent]
})
export class AppModule { }
                            </code>
                        </pre>    
                    </section>

                    <section>
                        <h4>Imports</h4>
                        <ul>
                            <li class="fragment">Expects an array of modules - only <b style="color: green">NgModules</b></li>
                            <li class="fragment">NgModules don't inherit access to the declaration of other NgModule - it must import what it needs</li>
                        </ul>
                    </section>

                    <section>
                        <h4>Declarations</h4>
                        <ul>
                            <li class="fragment"><b style="color: green"> Components / Directives / Pipes </b> belonging to the NgModule - only Declarables </li>
                            <li class="fragment">Declarables are only visible in the module that they are declared in!</li>
                        </ul>
                    </section>

                    <section>
                        <h4>Exports</h4>
                        <ul>
                            <li class="fragment">All declarables are private by default</li>
                            <li class="fragment">We can export <b style="color: green">declarables</b> in order to use them in other modules as well </li>
                            <li class="fragment">We can export also <b style="color: green">imported modules!</b></li>
                        </ul>
                    </section>

                    <section>
                        <h4>Providers</h4>
                        <ul>
                            <li class="fragment"><b style="color: green">Services</b> declared here will be visible app-wide( scoped using lazy-loading)</li>
                            <li class="fragment">When there are multiple providers for the same injection token, the last registration wins. </li>
                            <li class="fragment">root-scoped / module-scoped -
                                <i>Component providers always supersede NgModule providers</i>
                            </li>
                        </ul>
                    </section>

                    <section>
                        <h4>Bootstrap</h4>
                        <ul>
                            <li class="fragment">The component(s) to bootstrap </li>
                        </ul>
                    </section>

                    <section>
                        <h4>entryComponents</h4>
                        <ul>
                            <li class="fragment">Components that cannot be reached by compiler </li>
                        </ul>
                    </section>

                    <section>
                        <h4>AppModule / Application root module</h4>
                        <ul>
                            <li class="fragment">Contains the component for bootstrap - launch the app</li>
                            <li class="fragment">Dynamic bootstraping - JIT Compiler</li>
                            <li class="fragment">Static bootstraping - AOT Compiler</li>
                        </ul>
                    </section>
    
                    <section>
                        <h4>Feature modules</h4>
                        <ul>
                            <li class="fragment">Same properties and metadata as the Root Module</li>
                            <li class="fragment">Share the same execution context, same injector as Root Module - services available to all</li>
                            <li class="fragment">Extends the app</li>
                            <li class="fragment">Can expose or hide its implementations from other modules</li>
                            <ul>
                    </section>
    
                    <section>
                        <h4>Shared Module</h4>
                        <ul>
                            <li class="fragment">Exists to make commonly used components, directives, and pipes available for use in many other modules</li>
                            <li class="fragment">Don't specify providers here!</li>
                            <li class="fragment">Can export modules without using their functionalities</li>
                            <ul>
                    </section>
    
                    <section>
                        <h4>Core Module</h4>
                        <ul>
                            <li class="fragment">Pure service module with no declarations</li>
                            <li class="fragment">Specify the Core items that will be used in all modules (eg: a UserApiService)</li>
                            <li class="fragment">Imported once when the app starts and never imported anywhere else</li>
                            <ul>
                    </section>

                    <section>
                        <h4>Check the application source code</h4>
                        <p>What modules should we create, and how to resturcture the project?</p>
                    </section>

                    <section>
                        <h4>Assignment</h4>
                        <ul>
                            <li>Move the directives, pipes into a SharedModule that will be imported in the AppModule</li>
                            <li>Create a CoreModule and provide the ProductService there, import CoreModule inside the AppModule</li>
                            <li>Move the ProductComponent and TagFilterComponent into the product-list directory</li>
                            <li>Move the product.model into the product directory</li>
                        </ul>
                    </section>

                    <section>
                        <h4>Kahoot</h4>
                        <a href="https://play.kahoot.it/v2/?quizId=c67faaa0-2a0d-4550-b634-198463a454ff" target="_blank">Observables</a>
                    </section>

                    <section>
                        <h4>Recap</h4>
                        <ul>
                            <li>RootModule (AppModule) contains the root module for our application together with the component that will be bootstrapped initially</li>
                            <li>FeatureModules represent all the application sub modules, it's up to us to define them and structure our application with them</li>
                            <li>CoreModule contains only singleton services, and will be imported into the RootModule</li>
                            <li>SharedModule contains reusable components/directives/pipes and modules that it exports in order to provide FeatureModules with the componenents/modules that they depend on</li>
                        </ul>
                    </section>
                </section>

                <!-- Http -->
                <section>
                    <h4>Http</h4>
                </section>

                <!-- Routing -->
                <section>
                    <section>
                        <p>Routing</p>
                    </section>

                    <section>
                        <h4>Single-Page applications (SPA)</h4>
                        <p>SPA don’t refresh the entire page to display different views</p>
                        <p>SPA is a collection of view states: Home, Product Detail, Transaction history.</p>
                        <p>The router allows the user to navigate between views inside a SPA</p>
                    </section>

                    <section>
                        <img height="600px" src="./img//router-outlet.png" />
                    </section>

                    <section>
                        <h4>Route configuration</h4>
                    </section>

                    <section>
                        <pre>
                                <code class="hljs javascript">
    import { Router } from '@angular/router';
    import { ProductListComponent } from './product';
    import { ProductDetailComponent } from './product/details';

    const routes: Routes = [
      {
        path: 'products',
        component: ProductListComponent
      },
      {
        path: 'products/:id',
        component: ProductDetailComponent
      }
    ];
    
    @NgModule({ 
      exports: [RouterModule.forRoot(routes)],
    })
    export class AppRoutingModule { }
                            </code>
                        </pre>  
                    </section>

                    <section>
                        <h4>Navigating between routes</h4>
                    </section>

                    <section>
                        <h4>Navigation with routerLink directive</h4>
                        <pre>
                            <code class="hljs javascript">
    import { Component } from '@angular/core';
    
    @Component({ 
      selector: 'wsh-component',
      template: `
        <a [routerLink]="['/products']" routerLinkActive="class-when-route-is-active">Product List</a>
        <a [routerLink]="['/product', productId]" routerLinkActive="class-when-route-is-active">Details</a>
      `
    })
    export class AppComponent {
        protected productId = 2;
    }
                            </code>
                        </pre>
                    </section>

                    <section>
                        <h4>Programatic navigation</h4>
                        <pre>
                            <code class="hljs javascript">
    import { Component } from '@angular/core';
    import { Router } from '@angular/router';
    
    @Component({ 
      selector: 'wsh-component',
      template: `
        <a (click)="navigateToProductList()">Product List</a>
        <a (click)="navigateToProduct(productId)">Details</a>
      `
    })
    export class AppComponent {
        protected productId = 2;

        constructior(private router: Router) {}

        protected navigateToProductList() {
            this.router.navigate(['/products'])
        }

        protected navigateToProduct(productId) {
            this.router.navigate(['/product', productId])
        }
    }
                            </code>
                        </pre>
                    </section>

                    <section>
                        <h4>Retrieving params in a route</h4>
                        <pre>
                            <code class="hljs javascript">
    import { Component, OnInit } from '@angular/core';
    import { ActivatedRoute } from '@angular/router';
    
    @Component({ 
      selector: 'wsh-product-details',
      template: `
        {{ productId }}
      `
    })
    export class AppComponent implements OnInit{
        protected productId = null;

        constructior(private route: ActivatedRoute) {}

        ngOnInit() {
            this.productId = this.route.snapshot.paramMap.get('id');
        }
    }
                            </code>
                        </pre>
                    </section>

                    <section>
                        <h4>Assignment</h4>
                        <ul>
                            <li>Create an AppRoutingModule</li>
                            <li>Add the router-outlet component in the app.component.html</li>
                            <li>Add two routes: products, products/:id (product list, product details)</li>
                            <li>Add routerLink to the "home" button inside the navigation - it should route to the product list</li>
                            <li>Add routerLink to the "more details" button inside the product, it should route to a product detail page</li>
                        </ul>
                    </section>

                    <section>
                        <h4>Lazy loaded modules</h4>

                        <ul>
                            <li>The app startup time is shorter</li>
                            <li>Splitting the app into modules allows creating reusable chunks of code, e.g. ShippingModule</li>
                            <li>During bundling, the lazily loaded module is placed in a separate bundle</li>
                            <li>The code is loaded only when the user navigates to the module</li>
                        </ul>
                    </section>

                    <section>
                        <pre>
                            <code class="hljs javascript">
import { Router } from '@angular/router';
import { HomeComponent } from './home/home.component';

const routes: Routes = [
  {
    path: 'home',
    component: HomeComponent
  },
  {
    path: 'products',
    loadChildren: './product/product.module#ProductModule'
  }
];

@NgModule({ 
  exports: [RouterModule.forRoot(routes)],
})
export class AppRoutingModule { }
                            </code>
                        </pre>  
                    </section>

                    <section>
                        <pre>
                            <code class="hljs javascript">
import { Router } from '@angular/router';
import { ProductListComponent } from './product-list/product-list.component';
import { ProductDetailsComponent } from './details/product-details.component';

const routes: Routes = [
  {
    path: '',
    component: ProductListComponent
  },
  {
    path: '/:id',
    component: ProductDetailsComponent
  }
];

@NgModule({ 
  exports: [RouterModule.forChild(routes)],
})
export class ProductRoutingModule { }
                            </code>
                        </pre>  
                    </section>

                    <section>
                        <h4>Assignment</h4>
                        <ul>
                            <li>Create an empty HomeComponent and add a route 'home' for it in the AppRoutingModule</li>
                            <li>Create a ProductModule and move all the declarations to the ProductModule</li>
                            <li>Create a ProductRoutingModule (add it to the imports section for the ProductModule as well) and define an empty route which loads the ProductListComponent</li>
                            <li>Define a /:id route which loads the ProductDetailsComponent</li>
                            <li>In the AppRoutingModule we need to remove the product relate routes and have only a product route which lazily loads the ProductModule</li>
                        </ul>
                    </section>

                    <section>
                        <h4>Preloaders</h4>
                        <ul>
                            <li>During the app launch, it can preload all lazy modules in the background while the user is interacting with your app</li>
                            <li>Add preloadingStrategy to the routes config</li>
                        </ul>
                        <pre>
                            <code class="hljs javascript">
const routes: Routes = [
    ....
];

@NgModule({ 
  exports: [RouterModule.forRoot(routes, { preloadingStrategy: PreloadAllModules })],
})
export class AppRoutingModule { }
                            </code>
                        </pre>
                        <ul>
                            <li>You can create a custom preloading strategy by creating a class that implements the PreloadingStrategy interface.</li>
                        </ul>
                    </section>

                    <section>
                        <h4>Guards</h4>
                    </section>

                    <section>
                        <ul>
                            <li>CanActivate mediates the navigation to a route</li>
                            <li>CanActivateChild mediates the navigation to a child route </li>
                            <li>CanDeactivate mediates the navigation away from the current route </li>
                            <li>Resolve performs route data retrieval before route activation</li>
                            <li>CanLoad mediates the navigation to a feature module loaded asynchronously</li>
                        </ul>
                    </section>

                    <section>
                        <ul>
                            <li>canActivate - allows navigating to a route if a certain canDeactivate - allows navigating from a route if a certain condition is met, e.g. the user is logged in</li>
                            <li>canDeactivate - allows navigating from a route if a certain condition is met, e.g. prompting about saving changes</li>
                        </ul>
                        <pre>
                            <code class="hljs javascript">
const routes: Routes = [
  {
    path: 'home',
    component: HomeComponent
  },
  {
    path: 'products',
    loadChildren: './product/product.module#ProductModule',
    canActivate: [LoginGuard],
    canDeactivate: [UnsavedChangesGuard]
  }
];

@NgModule({ 
  exports: [RouterModule.forRoot(routes)],
})
export class AppRoutingModule { }
                            </code>
                        </pre>  
                    </section>

                    <section>
                        <h4>Can Activate Guard</h4>
                        <pre>
                            <code class="hljs javascript">
@Injectable()
export class LoginGuard implements CanActivate {
    constructor(private router: Router){} 
    
    canActivate() {
        // A call to the actual login service would go here
        // For now we'll just randomly return true or false
        const loggedIn = Math.random() < 0.5;

        if(!loggedIn){
            alert("You're not logged in and will be redirected to Login page");
            this.router.navigate(["/login"]);
        }
        return loggedIn; 
    }
}
                            </code>
                        </pre>  
                    </section>

                    <section>
                        <h4>Can Deactivate Guard</h4>
                        <pre>
                            <code class="hljs javascript">
export class UnsavedChangesGuard implements CanDeactivate&lt;ProductDetailComponent&gt; {
    constructor(private _router:Router) { } 
    
    canDeactivate(component: ProductDetailComponent){
        if (component.name.dirty) {
            return window.confirm("You have unsaved changes. Still want to leave?");
        }
        return true;
    }
}
                            </code>
                        </pre>  
                    </section>
                    
                    <section>
                        <h4>Why should we preload data?</h4>
                        <ul>
                            <li>The connection is slow and it takes two seconds to retrieve the data. The user will look at the empty component for two seconds.</li>
                            <li>
                                If the server request returns an error, the user will look at the empty component just to see the error message.
                            </li>
                        </ul>
                    </section>

                    <section>
                        <img src="./img/resolvers.png" height="600" />
                    </section>

                    <section>
                        <h4>Kahoot</h4>
                        <a href="https://play.kahoot.it/v2/?quizId=6b17bde6-b52f-4692-996f-c818ef91caf5" target="_blank">Router</a>
                    </section>
                </section>

                <section>
                    <section>
                        <h4>Forms</h4>
                    </section>

                    <section>
                        <h4>Native implementation</h4>
                        <img src="./img/native-forms.png" />
                    </section>

                    <section>
                        <h4>SPA need more than just a native html form</h4>
                        <ul>
                            <li>Get a value from one or all form controls</li>
                            <li>Validation for individual and grouped form controls Displaying error messages next to the form control </li>
                            <li>Has the user changed or visited a form control? </li>
                            <li>Event handling</li>
                            <li>Dynamic creation of form controls</li>
                        </ul>
                    </section>

                    <section>
                        <h4>There are two types of forms API</h4>
                        <ul>
                            <li>Template-driven - the form model is defined in the component's template using directives. The underlying form model is created implicitly.</li>
                            <li>Reactive - the developer explicitly creates an underlying form model in the TypeScript code.</li>
                        </ul>
                    </section>

                    <section>
                        <ul>
                            <li>For template-driven forms: import <b style="color: green"> FormsModule </b> in @NgModule()</li>
                            <li>For reactive forms : import <b style="color: green"> ReactiveFormsModule </b> in @NgModule()</li>
                        </ul>
                    </section>

                    <section>
                        <h4>Reactive forms</h4>
                        <ul>
                            <li>Create a model programmatically in the TypeScript code</li>
                            <li>Link HTML elements to this model using directives in the template You can dynamically configure validators</li>
                            <li>You can use RxJS operators for handling form’s values</li>
                        </ul>
                    </section>

                    <section>
                        <h4>Classes that help us create the Reactive Form</h4>
                        <ul>
                            <li><b style="color: green">FormControl</b> - represents a single form element</li>
                            <li><b style="color: green">FormGroup</b> - represents a part of the form and is a collection of FormControls</li>
                            <li><b style="color: green">FormArray</b> - similar to FormGroup, but it has variable length. It’s useful for creating form fields dynamically</li>
                        </ul>
                    </section>

                    <section>
                        <h4>Assignment</h4>
                        <ul>
                            <li>Create an AddProductComponent</li>
                            <li>Create a new route for it (products/add)</li>
                            <li>Add a button in the product list that links to the newly added route</li>
                            <li>Using reactive forms create a form in order to add new products</li>
                            <li>Save the product</li>
                        </ul>
                    </section>

                    <section>
                        <h4>Kahoot</h4>
                        <a href="https://play.kahoot.it/v2/?quizId=9c45b52a-a66b-4564-9774-989af05f81a7" target="_blank">Router</a>
                    </section>
                </section>

                <section>
                    <img src="./img/ngrx-intro.png">
                </section>

                <section>
                    <img src="./img/ngrx-store.png">
                </section>

                <section>
                    <h4>Assignments</h4>
                    <ul>
                        <li>Create 3x Actions (LoadProduct, Success, Error)</li>
                        <li>Add a selectedProduct property to the product state, interface</li>
                        <li>Handle the 3 action type cases in the reducer</li>
                        <li>Create effect to handle the loading of the product</li>
                        <li>Create getProduct method in the ProductsStoreService</li>
                        <li>Refactor Details Component so that it uses the redux flow</li>
                        <li>Change edit page resolver so that it works with the store approach</li>
                    </ul>
                </section>

                <!-- Testing -->
                <section>
                    <section>
                        <p>Testing</p>
                    </section>

                    <section>
                        <p>Unit tests</p><br />
                        <p>In order to write the actual tests we use Jasmin together with Angular Testing Module (@angular/core/testing)</p>
                        <p>In order to run the tests we use the test runner Karma</p>
                    </section>

                    <section>
                        <p>Jasmine terminology</p>
                        <p>A test is written in the function it()</p>
                        <p>A test suite is written in describe()</p>

                        <pre>
                            <code data-trim class="hljs javascript">
import AppComponent from ‘./app.component';

describe('AppComponent', () => {
    it('is successfully instantiated', () => {
        const app = new AppComponent();
        expect(app instanceof AppComponent).toEqual(true);
    });
});
                            </code>
                        </pre>
                    </section>

                    <section>
                        <p>Jasmine matchers</p>
                        <img src="./img//jasmine_matchers.png" />
                    </section>

                    <section>
                        <p>Setup and teardown</p>

                        <p> Setup. Include the functions beforeAll() and beforeEach()
                            in your spec file with the code to execute before all or each spec.</p>
                        <p>Teardown. Include the functions afterAll() and afterEach() 
                            with the code to execute after all or each spec.</p>
                    </section>

                    <section>
                        <p>Adding coverage to the test</p> <br />
                        <p>ng test --code-coverage</p>
                    </section>
                </section>
            </div>
        </div>

        <script src="lib/js/head.min.js"></script>
        <script src="js/reveal.js"></script>

        <script>
            // More info https://github.com/hakimel/reveal.js#configuration
            Reveal.initialize({
                history: true,

                // More info https://github.com/hakimel/reveal.js#dependencies
                dependencies: [
                    {src: 'plugin/markdown/marked.js'},
                    {src: 'plugin/markdown/markdown.js'},
                    {src: 'plugin/notes/notes.js', async: true},
                    {src: 'plugin/highlight/highlight.js', async: true, callback: function () {
                            hljs.initHighlightingOnLoad(); }}
                ]
            });
        </script>
    </body>
</html>

